from collections import defaultdict

import numpy as np
import numpy.typing as npt
from scipy import signal


example = \
"""
..@@.@@@@.
@@@.@.@.@@
@@@@@.@.@@
@.@@@@..@.
@@.@@@@.@@
.@@@@@@@.@
.@.@.@.@@@
@.@@@.@@@@
.@@@@@@@@.
@.@.@@@.@.
"""

puzzle = \
"""
@..@@.@@@@@@@@..@@@@.@.@@@....@.@.@.@@@@@@@.@@@@@.@..@..@...@..@@@.@@.@.@..@...@@@@@..@@..@..@@.@@@@@....@.@.@@@@..@.@@@.@@@..@.@@@@@@@.@
@@@@@..@@@@@..@@@.@@.@@@@.@@@@.@@.@.@@@@.@@@..@.@.@@@.@@.@.@@@.@..@@.@..@@@.@@@.@@@.@.@@@@@..@@@@@@@@@@.@@@@.@@...@@@@@@.@@@.@.@@@.@....@
.@@.@@@@@@.@@@@..@.@.@@..@@....@@@.@.@....@@@.@.@@..@.@@.@@.@@@@.@@@@@@@@.@..@@@@@@.@.@@@.@.@@.@@..@.@@.@@@@@@@@@..@.@.@@@@@..@.@@@@@.@.@
@@@@@@.@@@@..@@@@@...@.@@.@@@@..@@@@@@.@...@@@@@.@.@@@.....@@@@.@@@@@..@@@@..@.@..@.@@..@..@.@.@@@@@@@@@@@@.@.@.@.@.@@@@@@@..@.@@.@@.@@@@
@@@@...@.@@.@.@..@.@@.@.@@..@@@@.@@@.@.@...@.@@@@@@@@.@@@@@.@@@.@.@.@@.@@.@@..@@..@.@@@.@..@@@.@@@@@.@@@.@.@@@..@..@@.@.@@@.@@@..@.@.@@@.
.@...@..@@@.@@@@..@.@@@@@......@..@@.@.....@@@..@@.@.@..@.@@@.@@@@.@@@.@@.@@.@@.@.@@@@.@.@@@..@@@@@@@..@@.@.@@@....@@@@@@@@@.@@@.@@...@@@
@@.@..@@@.@@@.@@@.@@.@@@..@.@.@.@@..@.@.@@@.@@@@@@@@.@@@.@.@@@@.@.@@@.@@.@.@@@@.@..@....@@@.@..@@@@.@@@@@@.@@.@@@..@.@.@.@@@@...@...@.@.@
@.@...@@@@@@@@.@@@@.@@.@@@@@@.@@@@.@@.@@.@..@.@@@@@.@@.@@@.@@.@@@@@@@@@@@.@..@@@..@.@@.@.@.@@...@.@..@.@@@@.@@@@@.@.@@@..@@@.@.@..@.@@.@@
@.@@@@.@....@@.@.@@@@.@@.@.@..@@@@@@@..@...@@..@.@.@.@@@.@@@@.@.@@@@.@@@...@@.@@@@@@@@@@@..@@..@@..@...@..@@@..@@.@.@@@@@.@@..@@@@@@.@@.@
@.@...@@@@@@@..@@.@@@.@@@@@.@@@@@.@.@@@.@@.@@@@@@@.@@@@@.@...@@@@.@..@@...@@@@@@.@.@@@@@@@.@@@@@@..@@@@@@.@@@@..@@.@.@@@.@@@@.@..@.@@@@..
.@..@@.@..@...@@@@@@...@.@@@@.@.@@@@@.@.@@@.@.@@@@@@@@.@@@@..@@..@...@@@.@@...@.@@..@@@@@@.@@@@.@@@.@@..@@@.@@.@@@@@@@....@@.@.@@@.@.@@@@
@...@@.@.@.@@.@@@..@.@@@@..@@..@.@@.@@@.@@.@..@......@..@@@@@@.@@...@@.@.@.@..@@..@@@@@@@.@@.@...@@@.@@@.@@.@.@@.@@@.@@@@@@@.@@@@@@@.@@.@
@@@@@@@@....@@.@@.@@@@@..@@....@@@@@@.@@@@@@.@.@@@@.@@@@@@@...@@...@@@.@@@@@.@@@@@....@.@@@..@@@@.@.@@..@@@@@@@@.@@.@.@@...@@@@@@@@.@@...
@@..@@.@@@@@.@.@@.@@@@@@@@@@@@@@.@@.@@@.@@@.@@@@@@...@.@@@@.@.@@@..@@@@@@@.@@@@.@@@@.@@@@.@@@@@@@@@.@@@@@.@@@.@@.@@@..@@@@@@@.@@@@@@@@..@
@.@@@@...@..@@@@...@@.@@..@@@..@@.@..@@@@.@@@@..@@..@@@@@@@@@@@@@@.@.@......@@.@@.@@.@@.@@.@@.@..@@@@@@@@@@@.@..@@.@.@@@@.@.@@@.@@..@....
...@@@@.@@@@@@.@.@.@@@@@@..@@@.@...@@@@@..@@@..@..@@@.@@@@@@@@@.@@@@@@@@@.@@@@..@@@@@.@@.@@.@..@@..@@@@@.@...@.@@.@@@@@@@.@...@@.@@@@..@.
.....@@@...@.@.@.@@@@@@@@@@..@@@@@..@@@@@@@@@@.@....@@..@@@@@@@@@@@.@..@@.@@...@.@@..@.@@@@@@@@@.@..@@...@@@@@@...@@@@.@@.@.@@@@.@@@@....
@@@@@@.@@.@@@@@.@@@.@@@.@.@@@.@@.@@.@@..@..@..@.@@@.@@@@@.@@@@@.@..@@..@@.@@.@.@.@@@@@..@..@@@@@@@@@@.@@....@@...@@..@@@@.@@@@@@@@@@.@@@@
..@....@@@@.@.@..@@.@@@@.@@@.@@.@@.@..@@@@@@...@@@@@@@@@@@@.@.@@@@@@@@.@@@.@.@@@..@@.@@..@@..@.@.@@@@.@..@.@@@.@....@@@......@@@@@@@....@
@..@@@.@@@@.@@@@@.@@.@@.@.@..@.@@.@@@..@.@@.@@..@@@@...@@@@@@@.@@.@..@@@.@@......@@@@@.@@@@@.@@.@..@@@@@@..@@@@@..@.@@@@@.@@@@@@@.@@@@@@@
@@..@@@@.@..@..@.@.@@@.@@@@@@.@@@@@@@@@.@..@@..@@@@..@.@@@@@...@@.@.@@@..@..@.@@..@@.@@@@@..@@.@@@@@@@@@...@@..@.@@..@.@@@@..@.@@@@.@@@@.
.@@..@@@@@@.@@@.@@@..@@.@.@@@@@@.@@@..@@.@@@.@@.@@.@.@@@@@.@@@@..@@@@@@@@@.@.@@@@@@.@@@@@.@....@@@@@.@@@@@@....@@.@@@@@..@@@@@.@@@@@@@@..
@.....@..@.@@@..@...@.@....@@@.@@@@...@...@.@..@@.@@@@..@@@@.@.@@@@.@@@@....@@..@@.@.@@.@@.@@.@.@@@@@..@@..@..@.@@..@@@.....@.@.@..@.@@.@
.@.@@.@@..@@@...@@.@.@.@...@@@@@@.@@.....@@....@.@@.@@..@..@.@@@...@..@@@@@@@@.@.@@@.@.@.@@@..@.@@@@@@..@@.@@.@.@@@.@@@@@@@.@@@.@@.@.@@@.
@@@@@@@@.@...@@@.@@@@.@@.@@..@@@.@@@@@@...@.@.@@..@.@.@.@@@@@.@.@@@@.@@.@.@@..@@@@.@..@@.@..@.@@@@..@@@.@@...@..@@..@@@.@..@@..@@@@@@...@
@@@@..@@.@@@@..@@@@@.@@@.@@@@@@@.@@@@@.@@@@@@..@@@.@@.@@@@@@.@@.@@..@@@@@.@@@.@..@.@@.@@@@@.@@@.@.@@@.@@@..@.@@@..@@@@.@@@@@@@@.@.@..@@@@
@..@@.....@.@@.@...@@@@@@@.@.@.@@@@@@@@@.@@@@@@.@@@.@.@.@@.@@@@.@@.@@@@..@@@@@@@@..@@@@@@@...@@.@...@..@@@@@@@@@@@@.@..@@@@.@.@@@@@.@@..@
@@@@@@@.@@..@@@.@@.@@.@.@@@@.@@..@@@@..@.@@.@....@@.@.@@.@.@@@@..@@@@@@@.@@@@..@.@@.@.@@@@@@@@@.@....@@@@@@@@.@@@@..@.@@@@...@...@@@@..@.
..@@.@@.@@@.@..@.@@@@.@@@@.@...@@@@.@@.@..@@@.@.....@.@@...@@.@..@@@..@@.@@@@...@.@@....@.@@.@.@@.@.@@.@.@@...@...@@@@@.@..@@.@@@@@@@@@.@
@.@..@@.@@@@@@.@@..@@.@@.@@@@..@@@.@@@@@..@....@@@@@@@@@.@.@@....@@@.@@@.@....@@..@@@.@@@..@..@@@.@@@@@@....@@@@....@@@@@@.@@....@.@.@@@@
@@@@@@.@.@@@@.@@@@@.@.@.@.@@@@@@...@@@@@@@...@@.@@@.@@@@.@@.@@..@@.@@@@...@.@...@..@.@@.@@@@.@.@.@@@@..@@@@@....@@@@@.@@@.@@.@..@@@@@@@..
@@...@.@@.@@@..@@@@@...@@.@.@@@@@@.@@@@@@@.@@..@@@@..@@.@@..@.@@.@@@.@.....@.@.@@@@@@@@.....@@@@@@@@@..@.@@@@@...@.@.@@@.@.@.@@@.@@@@.@..
@@@@@.@@.@@.@@.@@.@@@@@@.@@@@.@@@.@..@.@@..@@@@@.@@.@@@.@.@@@@@@@@..@.@.@.@@@.@@@.@@@@.@.@...@@..@.@@.@@@@.@@@@..@.@....@@@@@@@@@@@.@@@@@
@@..@.......@@..@@@..@.@@.@@@..@@@@@....@@@@..@@@@@@.@..@.@@@@@.@@.@@@@@@.@@@..@@.@@@.@.@@@..@@@...@.@.@@@....@@.@@@@@@@@@@@..@.@@.@@@.@@
@..@.@@.@@@..@@..@@@@..@.@.@.@...@@@.@@@@@.@@.@....@.@@@@@@..@.@.@.@.@..@....@.@@.@@@.@@@.@@@..@@@...@@@@.@..@@@@@@.@@@@@@@@@.@.@@@..@@@.
@.@@@.@@@@@@@.@.@@@@.@@@@.@.@.@@@.@.@.@..@..@@.@..@@@@@..@@@@@@@@.@@@....@@..@@@.@.@@@@.@@@@@..@.@@@@@@.@..@@......@@@@..@..@@@.@@.@@@.@.
@@..@@@@..@@@@@@.@..@@.@...@..@@@.@@.@@@@@..@@@@@..@@@.@.@.@..@@.@@.@@@@@@@@@@@.@@.@.@.@.@.@.@@@.@@@@@@.@@.@@@.@.@@.@.@@.@...@..@.@@@..@.
@@@@.@.@@@@..@..@@..@...@..@@.@@.@..@@.@@@.@@@@...@.@@@@@@.@.@@@.@@.@.@...@@@@...@.@@.@.@.@@@@...@@.@@@.@@..@@@@@.@.@@@@@@@@..@....@@@@@.
@.@..@@.@@..@.@..@@.@@@@.@.@@.@@@..@.@@@@@@..@@@.@@@.@@.@@@@@@.@@.@@@...@.@.@@.@@..@@..@@@...@....@..@@...@...@@@@@.@@@...@@@@@@...@@.@@@
@@@@@@@@@..@.@@@@@@.@@@..@@..@@@.@@@@.@@@@@@@@.@.@.@.@@.@@...@@..@..@@...@@.@@.....@.@@@.@..@@@.@.@@...@@@@@.@.@@.@@.@.@@.@@@@@.@@@.@.@..
@....@@@.@@.@@..@.@.@.@@.@@@.@..@..@@@@..@..@.@@@.@@..@@.@.@@@@@@..@.@@.@@.@.@.@@@.@@@.@....@@..@@@@.@@@.@.@@...@.@....@@@@@@@@@@@.@.@.@.
.@@@..@.@@@.@.@...@@@.@.@@@@@.@@.@..@.@..@@.@@.@@..@.@@@@@@.@.@@.@.@@@@@@@@.@.@..@@.@@@@@@.@....@..@.@@@@.@@@@@@@.@@.@.@@..@@.@@@..@@@@.@
@@@@....@@.@@@@@.@@@@@@@@...@@.@@...@@@..@..@@@@@@@@.@@@@@@@..@@..@@@...@.@..@@.@.@@@@..@@.@@@.@@@@@@@.@@@.@@@@@@..@.@.@.@@...@..@@..@.@@
.@@..@@@@@@@..@.@@@@.@@@@.@@@.@@@@@..@...@@@.@@.@@@@.@@@.@@@@@.@@@@...@.@..@...@..@..@@@@..@...@@@@@@@@@@...@.@@.@@...@@@.@@.@..@.@@..@@.
@@.@@.@..@@@@.@@@.@@@.@@@@@@@@...@@@@@@.@.@@@@@@@.@@......@@@@@..@@@@@@@.@.....@@.@@@@..@@@.@@.@.....@@.@.@@@@@.@@@@..@@@@@@@@.@@@@@.@@@.
@@@.@.@@.@.@..@.@@....@@@@@@@@@@@@.@.@@@.@.@@.@@.@@.@@@@.@@@@@@.@@@@@@.@@@@@@@@..@@@@@@@..@@..@..@..@@@@@.@@@@@@@@.@.@..@@@@@@@@.@@@.@@.@
@.@@@@@.@@.@@@@@..@.@@@@.@..@.@@.@@@.@@@@.@@.@..@@@@@@@.@@@.@@@.@.@@.@.@..@@.@@.@.@@@.@.@.@@.@@.@@@@@@@...@@@.@.@..@@.@@.@@@@@@@@@.@.@.@.
@..@@@@@@@@..@@@.@@@@@@..@@@.@@@@@@.@..@@@..@.@.@@..@@.@.@@..@@@@@.@.@@.@@@@.@.@@@@.@.@@@.@..@@@@@@@.@@@.@.@@.@@@@@@@@@...@.@@@..@.@@.@@@
@@.@.@.@@@@@.@@@@@...@@.@.@@.@@@@.@.@@..@@..@@@.@@@@@.@@@@.@@.@@@@@@@@@.@@.@@@@@@....@..@..@.@@@@@@@@@.@@@.@.@.@.@.@@..@.@@@@@@..@.@.@..@
@@.@@@@@@@.@@@@.@@@@@@.@..@.@@@.@@.@.@.@@@.@@@@.@@@@.@@.@@@.@@@@@@@@.@.@..@@@@..@.@@@@...@@@...@.@.......@.@@.@@@.@@@@@@..@@@.@@@@@.@@.@.
.@.@.@@..@@..@.@@@@@@@@@.@@@@@@..@@@@@@.@.@@.@.@@.@.@@@@.@@@..@@@..@@@@@@@@@.....@@.@@@..@@@@@...@.@@....@@@@..@@.@@.@@@.@@@@@.@@.@@@@@@.
.@@..@@@@@@..@@@@@@.@...@.@.@@.@@@@@.@@@@..@.....@@.@@.@.@@.@@@.@@@.@.@@.@@@@..@.@@.@....@.@@.@@@.@.@..@@@@@.@@@.@@@@@@.@@@@.@@@@..@.@@@@
@....@@.@@@@@.@@..@@@@@@@@@@@@@@@@.@@@.@@@@@..@@.@.@@@@....@.@@.@@.@@@@@@..@.@@@.@@@.@@.@..@@@....@@@@@..@@@.@@@..@@.@@@@@@@@..@@@@@@@.@@
@@.@@@@@@@@...@....@.@..@@@@.@@.@@@..@.@.@.@..@@@@@.@@@@..@@.@@...@.@.....@@..@.@.@@@.........@@@@@@@...@..@..@@@@.@@@@.@@.@@@@@@@.@.@@@@
@@@@@@...@@@.@@@@@@.@.@@@...@...@@..@@@@@@.@@@@.@@..@@.@@@..@@.@@@.@@.@.@@.@@.@@.@@@@..@@@.@..@@@..@.@@@@@@.@@@@.@@.@.@@@.@@@...@@@@@@.@.
@@@@..@..@.@@@@@@@.@@.@.@.@@.@@@@@@@.@@@@.@@.@@@@...@@@@@@@@@....@@@@@.@.@@.@@@@@@@@@@@.@...@.@.@.@@@.@..@@@@.@.@@@@.@@.@.@@@.@..@@.@.@@.
.@.@@@@.@@...@@@@@....@.@..@@...@..@@@@@@..@.@@.@@@.@@..@.@@@@...@..@@@....@.@@@.@@.@.@@.....@@@@@.@@..@@@@..@@.@.@.@@@@.@@.@@@@@@@@@..@.
@@@@@..@@.@.@.@..@.@....@@@@..@@...@@..@@@@@@@@@.@@@@..@@...@..@.@@..@.@@@@@.@@@.@@@.@.@@@@@.@.@..@@.@@...@@@...@@@@.@@@@@.@@@@..@@.@..@@
@.@.@@...@@.@@@@@.@@@@..@@@.@@@@@...@@.@@@@@.@@@@@.@@@.@@@@@@@@@.@@@.@@@@..@@@@.@.@.@.@@.@@.@@@@.@.@.@@@@@@@.@@.@@@@.@@@@@@..@@@.@@.@...@
@@@.@...@.@@@@.@@@.@.@@@@@.@@.@.@@.@.@.@.@@@@.@..@@@.@@@@@.@@@@..@.@@@@@@..@.@@@@.@@.@@@@@@@.......@@@.@@@@..@@.@@@.@.@@@..@@.@@@.@@@....
....@@...@@@@@@@@..@.@@.@@@@.@@@@@@@@.@.@.@@@@@.@@..@.@@.@@@@..@.@@@@@@@@...@@@@@@.....@@.@@.@@.@@@@.@@@@@.@@...@.@@.@@@@.@...@@@@@..@@@@
@@@@@.@@@.@@@@@@.@@..@@.@@..@@@@@@.@.@.@@@@@.@@@@@.@...@@@.@.@.@@@.@@@@@.@@.@.@@.@.@@@@@@@@.@..@@@@@..@..@@@@..@.@@.@@@@@.@.@.@@@@...@@.@
@@@@.@@.@@@.@@@@.@@@@.@.@..@@@@@@@@.@.@@@...@..@@.@@@@@@..@..@.@@@@@...@.@@@@@@@@@@...@@.@..@@..@..@@@@@.@@@@@@@.@@...@@@@.@@@@@@@@@@@.@.
....@@@.@@...@@@.@@.@@@@.@@@@...@@@@@.@@@..@@@@@@..@@@.@@@@@...@@..@....@@@@@.@@@..@@@@@.@@@@.@@@.@..@@...@@.@@@@@..@@@@.@@@@..@@.@@@.@@@
@.@@@@...@@...@@@@.@.@.@@.@@@...@.@@@@@@.@@@@.@.@.....@..@@@.@@.@...@.@....@@@...@.@@@@@@.......@@@@@..@@.@..@.@...@@@..@.@.@@@.@@....@@@
.@@@.@@.@@@@@.@.@@..@@@...@.@@@.@@@@@@@@@@@@.@...@@@.@@@...@.....@@.@@@.@@@@@@.@@.@.@@@.@@.@@..@@@..@@@@..@.@@@..@.@..@@@@@@.@@.@.@@.@@@@
...@@@@.@@@...@@@@.@@@@...@@@@@@@@....@@@@.@.@.@.@@..@@@@@.@@@@@..@@.@..@@@....@.@...@.@@@.@@@@@@@@@@..@@@..@@..@@@@@@@@..@.@..@@.@@.@.@@
..@..@@@@@@@.....@.@@@@@@@.@.@..@@@.@@.@..@@@@.@.@@.@.@..@@@@@@@@..@@..@@..@@...@@.@@@@..@@@@.@.@...@@@@@@.@@.@@..@@@@.@@@@@@@.@@.@..@.@@
@@@@.@@.@.@@...@@..@.@@@@.@.@@@.@@@@@@@@@@@@@...@@.@.@@@.@.@..@.@...@@@@@@@.....@@@@@.@@.@@@@...@@@.@..@@@@....@.@...@..@@@@@@@@@.@@@.@.@
.@@.@@@..@...@@@@@@@@@.@@@@@@@@@@.@@..@@..@.@.@.@@.@@..@.@@.@.@.@@....@@@@@@...@@@@.@@@.@@@@..@@@@@@@.@@.@@@.@@@@@@@.@..@.@.@..@@@..@.@@@
@@@.@@@....@@@.@@@...@..@@...@.@.@@@.@@@.@...@.@.@..@@@@@@.@.@@@.@@.@@@..@...@....@@@@..@@@@@@.@@.@@@@.@.@..@..@..@@@@@..@..@@@@@@@.@@.@@
@.@@@..@@@@@..@@@@@@@@@@@@.@@@@@@.@.@@.@......@@@@@@.@@@.@@...@@..@@@@@@.@@@..@@@.@@@@..@@.@@@@@..@@.@@@.@..@.@.@@@@.@..@.@@@@@@@@@.@@..@
@@@..@..@@@...@.@@@@..@..@@.@@@@@....@@@@@@@@.@@@@@@@.@.@.@.@..@....@@..@@@.@@@@.@@....@.@@@@.@@@@.@@.@@@@@@@@@@@@@.@.@.@@@@@@..@@@@@@.@@
.@@@@@@@@@..@.@@....@@.@.@@.@@@.@@.@@.@.@@.@@@@..@.@@@@@@@@......@.@.@.@@@.@@@@.@@.@@@@@.@@.@.@@..@.@@.@@@.@@@@.@@@@@.@@@.@@@...@.@@.@.@@
@.@@@@..@@@@.@.@.@@@.@@@@@.@@.@..@@@@.@@@@..@..@.@..@@@...@@.@.@@@@.@@@.....@.@.@.@@.@@@.@@@@..@..@@@....@.@.@@@@@.@@..@@@@@@@@@.@.@@@@@.
@@@@.@.@@..@.@.@@.@@@@.@@.@@@@@.@..@.@.@@.@@@..@@.@.@@.@@.@@.@@@@...@.@.@@@.@...@.@@.@.....@@@.@@.@@@@@@@...@@@@@.@@.@@@.@.@@.@.@@@@.@.@@
...@..@.@.@@@@..@@@@@...@@..@.@@@@@@.@@@@@..@@@@@@.@@@@.@@@@@@....@@@@@@.@.@@.@@.@.@@@@..@.@.@.@@@@....@@@@@@.@@@@@@.@.@@.@@.@@.@@..@@@@@
@@@.@@@@@@@@@@@@.@@@@...@@@..@@.@.@...@@.@.@@@.@.@@@.@@@@@@@@@.@@@@..@@@@@@@.@@.@@@@@@@@@@@@.@..@..@@.@@.@@..@@@..@@@@@@@@...@@@.@@...@@@
..@@@@...@.@..@@@@.@.@@@@@.@@@.@@@@@@@@.@....@@@...@..@.........@@@..@.@..@@..@@@@@@@@@.@@@@@@@.@@@@@..@@.@.@@@.@..@@@@@.@.@..@@@@.@@.@@.
@.@@@.@@@@.@.@.@.@@@@@@.@.@@@@@...@...@@.@..@@@@@@@@..@..@@@.@@..@@..@...@@@..@@@@...@@..@@@@.@@@.@@@@@.@..@@.@@@@.@@@..@@@..@@@@@.@@@..@
@@@.@.@.@@@@.@@.@...@..@@@@.@.@@@@@@@.@@@@..@@@.@..@@@@..@@.@@@..@@.@@@...@@@.@..@...@@@.@@.@@@@@@@@@.@.@@@@.@@.@.@@@.@@.@@@.@@@.@@@@.@@@
@..@@@@@@.@@.@.@@@@@@@@.@@@.@@.@@@.@.@@@@.@@@@@@.@...@.@@@@@.@.@@@@@@.@.@..@.@@@.@@@@@.@@@.@.@...@.@..@@.@@..@@@..@@.@@.@@.@.@@@.@@.@@@@@
.@@@.@@@...@@..@@@@@.@@@@@@.@@@@@@@@@@@@.@@.@@@@@..@@...@@.@@@@.@.@....@.@.@@@..@.@@.@.@@@@@.@.@.@@@@@@.@@.@.@@@.@@.@@.@.....@.@..@@@@.@@
@@.@@@@@@..@@@...@@@@@@...@...@.@@@@.@..@.@..@..@.@@@@@.@@.@@@@@@.@@.@.@@.@..@@.@@@..@@@@@..@@@.@@@@@..@@@.@@@@@@@@@@.@.@.@@@@.@..@.@.@..
@@.@.@@.@@.@@@@@.@..@@@@..@@@..@@@@@@.@..@@@@..@@@@@.@@...@.@@@@@.@@@@.@@.@.@@.@@@@..@@.@@@@@@@@@@.@.@@@@@...@@..@@@.@.@@@.@@..@@@@@..@@@
.@...@@@@.@@@.@@@@@@..@@@@@@@.@@@..@....@@..@@..@@@@@..@.@.@.@@.@@.@.@@.@@.@@@@.@..@@@@@@.@@@@@@......@@@@@@@.@.@@@@@@@@@.@@...@@@..@.@.@
@@..@@@..@@@..@..@@@@.@@@@@@@@@.@@@@@.@@@@@@..@@@@.@.@.@@@.@@@@.@.@@..@@@@@..@.@.@@@@@@@@@..@.@.@@@@@...@@.@.@@@@@.@.@@@@.@@@.@@.@@@@.@.@
@@@@@@@.@@..@@@..@@@@@@.@@@@@@@.@@.@@@..@..@@@@@@@@..@.@@@...@@@.@@..@..@@@.....@.@@@.@.@.@@.@.@@..@@@.@@@.@..@.@@.@@.@.@@@@..@@@@@@@@@..
.@@@@@@.@@@@@.@@@@@@@.@@@@@.@@@.@.@@@..@@.@@@@@@.@.@@@@@@@@@@@...@.@@@@@@.@@.@..@@@...@@@@@@@@.@@@...@.@.@.@@@.@@@@@@@@@@@.@@@.@@@.@@@.@.
@@@@..@@.@@@@.@@@@@@@@.@@@@.@@.@@...@@@@@.@.@@@@@.@@@@@@@@.@@.@.@.@@..@@.@@.@...@@.@@@..@@@.@.@@@.@@@..@.@@@.@@@@.@@@.@@@@@@.@.@..@@@@@@@
@@@@@...@..@.@@@.@.@@@.@@@.@.@@@@.@@.@@..@@@@.@@@@.@.@@.@.@.@....@@@@@@.@@.@.@...@.@@..@@@@@@.@.@@@@.@@@@..@@@@@@@@@@.@@@@@@@@@@@@....@.@
@@.@@@@@@@@...@.@.@..@@@@@..@@.@.@.@.@.@@.@@..@..@@@@.@@@@@@@.@@.@.@..@.@..@@@.@@@.......@...@.@@...@@@@..@@@@.@@@@@.@.@@@@@..@@.......@.
@.@.@@@@@@@@.@@@@@@@@.@@@.@@@@..@.@@@.@.@@.@.@@@@@@@@@@@@.@@.@@.@.@@@.@@@@@.@@@@@@@@..@.@@@@@.@@@@@@@@.@@@@@@.@@@@@.@@@@@..@@@..@@@.@@@.@
@.@.@@@@@@@@@.@.@@@@.@.@@@@.@....@..@@@.@@@@@@@.@@.@..@.@@@.@@..@@@@@@.@@.@@@..@@@@@@@.@@.@.@..@@...@@@@@..@...@@..@@@@.@@@@...@.@@..@.@@
@@@@...@.@@.@@..@@@.@.@@@@@@.@@.@@.@.@..@@@@.@@@.@.@.....@....@.@@..@....@.@..@..@@@@@.@@..@....@..@.@..@.@@.@@@...@.@@.@@@@.@.@@@@..@@@@
.@@.@@.@@@@@.@@@@..@@@@@@@.@@.@@@.@@@.@@@@@@@@@@@.@..@@.@@....@.@..@@@.@@.@@..@@.@@@.@..@@@@@@@@@.@@@@..@.@..@@@.@@.@@@@.@.@@..@@@@@..@.@
@@@..@@@.@.@...@@@@..@@@@@@..@@.@@@@@@@@@@@.@@..@.@..@..@@@@@..@@@@..@@.@@@.@@.@.@.@.@@.@@@@@@@@.@..@@.@@...@@.@@@@@...@@@@@@.@@.@@@@@.@@
@..@@@@@.....@......@.@@@@@@..@@..@.@..@.@@@@@@@@..@@@@..@@.@.@@@@.@.@...@@@@@.@@@@@@.@@.@.@@@@.@.@..@@.@..@.@...@@@@@...@@@@.@.@@.@@...@
@....@@.@@@.....@@@@@@.@@.@@..@@...@.@@.@.@@@@@@@@@@@..@@.@@...@@@..@@@.@..@@@..@@.@.@.@@@.@@@.@@@@..@@@.@@@@@@@@...@.@@@@.@...@@@@...@@@
..@..@..@@.@@.@@@..@@@@.@.@..@.@@.@@@..@.@@@.@@.@..@@@@...@@@@@@.......@@...@.@.@.@.....@@@.@@.@@@@@.@@@@....@@@.@.@.@@.@@.@@@@@@@@.@.@@@
@.@@@@.@..@.@..@@@@..@@@..@@@@@.@@@@@@@@...@.@@@@@..@@@@@@@@..@@@.@@.@@@..@@...@@@.@.@..@@@@@@@@@@@@.@@@....@@.@@.@..@..@@@@@@@@@@.@.@@@.
.@...@.@.@@@.....@@.@@@@@@@@@@@@.@@@@@..@@@@.@@.@@@@@.@@@@@@@..@@@@.@@@.@.@@@@@...@@@.@@.@@@@@@@@@@@..@.@.@@@@.@@@.@@.@@@.@.@..@@.@.@.@@.
@@@@@@@..@@..@.@@@@.@@.@@@@@@@...@@@@@@.@@@.@@.@.@.@@@@@.@@@@.@..@@.@@.@.......@@..@@@@.@.@..@@@@.@@@@@@@@.@@@@@@@.@@@..@@..@@@.@.@@@@.@@
@.@.@@@@@.@@@@.@@..@@@@@.@@@.@.@.@@....@.@@.@@@@@..@@@@.@@..@...@.@.@.@@@@.@.@@@.@@@@@@@@.@@....@@@@@@..@..@.@@..@@.@..@.@...@@@@@@...@@@
.@....@@@@@@.@@..@@.@.@@@@@@.@@@.@@@..@@.@@.@..@@.@.@@.@@@.@@@@@@@.@..@.@@@@@.@@.@...@@@.@..@.@@@@@@@.@@..@@@.@.@..@..@@@@@@..@...@@.@.@.
@...@@...@.@@...@.@.@.@@@@@..@@@@@@.@@...@@@.@@@.@@@@@@@@@@@@@.@@.@...@@.@@@@..@..@@.@@@.@@@.@..@@@.@@@.@.@@..@.@.@@@...@@@.@.@.@...@.@..
.@@@....@@@@.@@@@@@@.....@@@@@@@..@.@.@@.@@@..@@.@.@..@@@@@.@@@.@@.@@@.@@@@@.@@@@@@@@@@.@@....@@..@@@.@@.@@@.@.@@.@@.@..@@.@.@@@@@..@.@@@
.@@..@@@.@@...@@.@@@...@.@@.@@@@..@@@@@@@@@@@@.@.@@@@.@.@@.@.@.@@@.@@.@@.@.@......@.@.@.@....@@@@@@@@@.@...@.@..@.@......@.@@.@@@@@@.@@@@
@@@@@@.@.@@@..@@@@@@@@.@@.@@...@.@@@....@@@@@@.@...@.@@@...@@.@@.@.@@@@..@.@.@@@.@.@@.@@@.@@@@@..@@@@@@@@@@@@.@@.@@@..@@.@@@@@@@.@.@@@@@@
@@@.@.@.@@@.@..@@@.@..@@@@@@@@@@.@..@@@@@@.@@.@.@@@@@.@..@@@..@@@.@.@@@..@@.@@.@@@@@@@@@@@@@...@@@...@@@..@@@.@.@.@@@@.@.@.@@@@.@.@.@@@..
..@...@@@@..@@@@@@.@....@@@.@.@.@@..@@@..@..@@@@...@..@.@@@.@.@@@.@.@@@@@@@@@@@@@@@@@..@@.@.@@@..@@@....@.@.@..@@@...@@@@.@@@@@@..@..@...
..@.@@@@@@.@.@@@@@@.@@@.@@@@@..@.@@@@@.@@@..@@@.@@@.@..@.@@....@@@@.@@.@@@@@....@@.@@@@.@@@....@..@@@.@@@@.@.@@@@.@.@@@.@@@@@@@.@@@.@@@@.
@.@@.@@.@.@@.@@@@@@@@@.@@@@....@@@.@.@@@@@@@@@@..@@@@@.@..@@.@.@@@.@.@.@@@@...@@.@@@.@@@@@.@.@@@@@@...@.@@@@@.@@@@@@@@.@@@.@@@.@@@@@@.@@.
.@..@@..@..@..@@@@@@.@..@@@@@@@@@@@@@..@.@@@@@@@.@@@.@..@@.@..@@.@@@@.@@@.@@@@@.@.@.@.@@@@@..@.@@.@@@..@@@.@...@@@@@@.@.@.@@@@.@..@.@@.@.
@@.@@@.@.@@.@@.@..@.@@.@..@@...@@@@@@@...@@@@@@@@@@.@@@@@.@@@@@@@@@@@...@@..@.@@..@..@.@.@@@@..@@@@@@@..@@.@@@@@.@.@.@@@@@@@.@@.@@.@@@@.@
@@.@@@..@.@.@.@.@@@@@..@@..@@@.@@@.@.@@@@.@@..@.@@.@@@@@@@@..@.@@@...@@.@...@.@@@@@@@.@@@@@@@..@@@@@@@@@@@.@.@@@@@@...@@@.@@@@@@@@@@..@@@
@.@.@@@@@@@@@@@.@.@@@.@@....@@@.@..@...@@@@.@..@@@..@.@@@@@.@.@@.@@@....@.@.@...@@.@.@@.@@@...@@@@@@@@.@.@.@.@@@@@..@@.@@@.@@@.@....@@@@@
..@@...@.@.@@@......@@.@@@@.@@..@@@@@@.@.@@@..@@.@@@@@..@@.@@.@.@@...@@@@@.@@....@.@@.@@@@.@.@@@@@@.@@@..@@@@.@@..@.@@@@@@..@@.@.@@..@@.@
..@@@@@@@@@@@@.@@..@@@@@@.@@..@.@@@.@@.@@@@@@@@..@@@@@...@@@.@@@@@@@@@@@.@@@@..@.@...@@@@@.@...@@..@.@@@@.@@..@.@@@@@.@.@.@@....@@@.@@@@@
@@@@@@@@@..@.@@@@@@@.@@@.@.@@@@@@@@@@@@.@@@..@@@.@@.@.@@@@.@@@@..@@@@@@.@@.@@@@..@@@.@@@@@@@@@..@@@.@@..@@@@.@@.@@.@@@@@@.@@@.@@..@.@@...
..@@@@...@.@@@.@.@@@@@@..@@.@@...@..@..@@@.@@@...@@@@.@@@.@..@.@@..@.@..@.@@@@@@.@@.@@@@@@@@...@@@@@@@@@@@@.@@.@..@.@@@@..@@.@.@.@@@.@.@@
.@.@@@@@...@@..@.@@@@@@@...@@@@@@@@@@.@@@@..@..@.@...@@@@.@.@.@@@..@@@.@@@.@@@@@..@.@@@@@..@@@@@@@@@@@@@@..@@.@@@@@@.@@@@.@.@@@..@@.@.@@@
@.@@.@.@...@.@@.@@@@@@@.@@.@@..@@@.@@@.@...@@@.@@.@.@@@@@@@...@.@@.@...@@@@.@@.@@@@.@..@@..@@@.@.@.@@@@@@@@..@@@.@.@@@.@@@@@@....@@.@@.@.
@@..@@@@.@@@.@.@@..@@@@@.@@@@@.@.@@@@@@.@@@@.@@@@@@@@.@@@@@....@@...@@@@..@@@@..@..@.@..@...@.@.@@@@@....@.@@..@@..@@..@@.@..@@...@.@@.@@
@@..@@..@.@@.@.@.@@..@.@...@@@..@.@@...@...@.@@.@@@..@@@@.@@.@@@@...@...@@@@@@..@@@.@@.@@.@...@@.@@@@.@.@@..@@@.@.@..@@.@@.@@@.@...@.....
@@@@@@..@@.@@.@.@@@.@@.@@@..@@@.@.@@@@@..@@@@@@@@.@@@...@@.@@@.@@.@@@@@.@@.....@@.@@@@@.@@@.@@@@@@@.@..@@..@@.@@@@@@@.@@.@@@@@.@...@.@@@.
.@..@@.@@.@@@@.@@.@..@..@@@@@@@@@@.@.@.@@..@@@@@...@@.@.@@@@.@@..@@@@@.@@@@@@@@@@@@@@.@@@@@.@@@@.@.@..@@@..@@@.@@@@@@@@@@.@...@@.@@@@..@.
@..@@@@@@...@@.@@@@@.@@.@@@@@@.@@@@.@@@.@.@.@.@@.@@@@..@...@@@.@...@@@@@@@@@@@@@@...@@@@..@@@@@@@@@@@@@..@.....@@.@.@@..@.@@@@..@@@@.@.@@
....@.@@@@@@@@@..@...@..@@@.@@@@..@@@@..@@...@@.@@@@@.@..@@..@@..@.@@@....@@@@@@@@@@..@@@@.@..@@@.@@@@@@@.@@@@@.@.@...@.@.@.@@.@@.@@..@@.
@@@.@@@.@@.@@......@@@@..@.@..@@@@@@@@@.@@@..@@.@.@@..@..@.@@.@@.@.@@.@.@.@.@..@...@.@@@@.@...@@..@...@@.@.@@@@.@@.@@@@@@@.@@@@.@@@@@@@@@
@@.@@..@@..@@@@.@@@...@@@.@@...@@@@@@@@@@@..@@@@........@@@@@@@@@@..@@@@@@.@@@@..@@@@@@..@@.@.@..@.@@...@@@@.@.@@@@@.@.@@@@@.@@.@@.@@..@.
@@@@@@@@@@@@..@@@..@.@@..@.@.@.@@.@..@@@@@.@.@@@@.@.@@.@..@@@..@..@@@@@@...@.@@.@@.@@..@.@.@@.@..@@@@@@@@...@@@@@.@@.@@@.@@.@@@.@@@@@.@@@
.@.@@@.@@@@@.@@.@@@@@@.@.@@@@@.@@..@@.@@@..@.@@@@@..@@@@@@@.@@.@@@@...@.@@@.@..@..@@.@@@@.@@@@@@...@@@@@@@@.@@@.@@@@@.@@@@@@@@@.@@@.@@@@@
@@@.@.@.@@...@@.@.@@@@@@@@.@@.@.@@@..@@@.@.@.@.@@@..@@@@@@..@@@@@@@.@..@.@.@@@@@@@@.@@.@..@.@@@@@@@.@@...@@..@@@@.@@.@.@.@.....@.@..@@@@.
@.@@@.@@@.@@@@.@@@@..@.@@..@.@.@@@@@.@@@.@.@.@..@..@@@@@.@@..@@@@.@@.@@...@..@@.@@@@@..@@..@@@@@@@.@@@...@@..@..@@@.@@@@@@@..@@@@@@@@@@.@
...@@@@.@@@@@.@.@@@@@@@.@@.@.@@.@.@@@..@.@.@@@.@@@......@@@@@@@.@@..@@@.@@@@@@.@.@@@@@@..@@..@....@.@@.@@@..@.@@@..@@@@@@@@@@@.@.@@@@@@@.
.@@@.@.@@.@@@.@@@@@@@@.@.@@.@@...@@@@@@.@@@@@@@@@@@@@.@...@.@@@@@@@@@.@@@@@@@@.@.@@@@@..@.@@@@@@@..@@@@@@@@@@@@@.@@..@@@@@@....@@..@.@@..
"""

def to_numpy(data: str) -> npt.NDArray[np.uint8]:
    cells = []
    mapping = defaultdict(lambda: np.uint8(0))
    mapping.update({
        ".": np.uint8(0),
         "@": np.uint8(1),
    })
    rows = 0
    cols = 0
    for i, line in enumerate(data.splitlines()):
        if i == 0:
            continue
        if cols == 0:
            cols = len(line)
        rows += 1
        for c in line:
            cells.append(np.uint8(mapping[c]))
    
    return np.array(cells, dtype=np.uint8).reshape((rows, cols))


def solve1(data: str) -> int:
    arr = to_numpy(data)
    convolution = np.ones((3,3))
    convolution[1,1] = 0

    neighbors = signal.convolve2d(arr, convolution, mode="same").reshape(arr.shape)
    return np.sum(arr[neighbors < 4])


def solve2(data: str) -> int:
    arr = to_numpy(data)
    convolution = np.ones((3,3))
    convolution[1,1] = 0

    total = 0
    stop = False
    while not stop:
        neighbors = signal.convolve2d(arr, convolution, mode="same").reshape(arr.shape)
        removed: int = int(np.sum(arr[neighbors < 4]))
        stop = removed == 0
        total += removed
        arr[neighbors < 4] = 0
    return total

if __name__ == "__main__":
    print(solve1(example))
    print(solve1(puzzle))
    print(solve2(example))
    print(solve2(puzzle))
